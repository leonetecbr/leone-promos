function igShare(t){const e=$(t).find(".product-title").html(),n=$(t).find(".description").html(),o=$(t).find("del").html(),i=$(t).find(".discount").val();$("#product-title").html(e),$("#product-image").attr("src",$(t).find(".product-image").attr("src")),$("#product-image").attr("alt",e),void 0!==o?($("#product-price-from").html(o),$("#price-from").show()):$("#price-from").hide(),$("#installment").html($(t).find(".installment").html()),void 0!==n?($("#product-desc").html(n),$("#product-desc").show()):$("#product-desc").hide(),void 0!==i?$("#product-code").show():$("#product-code").hide(),$("#product-price-to").html($(t).find(".pricing-card-title").html()),$("#share-link").html(getUrl(t)),$("#ig-share").removeClass("d-none")}function getText(t){const e=$(t).find(".description").html();let n=$(t).find(".pricing-card-title").html();const o=$(t).find("del").html();return"Grátis"!==n&&(n=`Por apenas: ${n}`),void 0!==o&&(n=`De: ${o} \n\n text`),n=`${$(t).find(".product-title").html()}.\n\n${n}!`,void 0!==e&&(n+=`\n\n${e}`),n}function getTextCupom(t){let e=$(t).find(".card-title").html()+" no(a) "+$(t).find(".loja-image").attr("alt");const n=$(t).find(".cupom-vigency").html();let o=$(t).find(".discount").val(),i=o.substr(0,o.length-2);return o="Cupom: "+i.replace(/\w/g,"*")+o.substr(-2),e+=`\n\n${n}\n\n${o}`,e}function getUrl(t){return"https://para.promo/"+btoa(t.replace("#promo-","o-"))}function getUrlCupom(t){return"https://para.promo/"+btoa(t.replace("#cupom-","c-"))}function accept(){createCookie("accept","true",365),$("#aviso_cookie").fadeOut("slow")}function copyS(t){if(navigator.clipboard)navigator.clipboard.writeText(t);else{let e=document.createElement("textarea");t=document.createTextNode(t),e.id="text-copy",e.appendChild(t),$("#noeye").html(e),$("#text-copy").select(),document.execCommand("copy"),$("#noeye").html("")}$("#copy-success").removeClass("d-none"),setTimeout((function(){$("#copy-success").addClass("d-none")}),3e3)}function copy(t,e){if(navigator.clipboard){const t=$(e).val();navigator.clipboard.writeText(t)}else $(e).attr("disabled",!1),$(e).select(),document.execCommand("copy"),$(e).attr("disabled",!0);window.open(t)}function submit(t){let e=getCSRF();$("#checkbox").append(e),$("#checkbox").submit()}function getCSRF(){let t=document.createElement("input");return t.setAttribute("type","hidden"),t.id="token",t.setAttribute("name","_token"),t.value=CSRF,t}function getReCaptcha(t){let e=document.createElement("input");return e.setAttribute("type","hidden"),e.id="g-recaptcha-response",e.setAttribute("name","g-recaptcha-response"),e.value=t,e}function createCookie(t,e,n){let o;if(n){let t=new Date;t.setTime(t.getTime()+24*n*60*60*1e3),o="; expires="+t.toGMTString()}else o="";document.cookie=`${t}=${e}${o}; path=/`}function getPrefer(t){$.ajax({url:"/prefer/get",data:JSON.stringify({endpoint:t,_token:CSRF}),dataType:"json",contentType:"application/json",type:"POST"}).done((function(t){if(t.success){let e=0;for(let n=0;n<t.pref.length;n++)t.pref[n]&&($("#p"+(n+1)).attr("checked",!0),e++);e==t.pref.length&&$("#all").attr("checked",!0),$("#preferencias").removeClass("d-none")}else null!=typeof t.message?alert(t.message):alert("Falha")})).fail((function(){alert("Falha")}))}function redirectUrl(){let t=$("#url").val();t=t.strstr("?"),window.open(`/redirect?url=${t}`),$("#url").val("")}function pesquisar(t,e){let n=getCSRF(),o=getReCaptcha(e),i=document.createElement("form");i.setAttribute("method","POST"),i.setAttribute("action",`/search/${t}`),i.id="pesquisar",i.appendChild(n),i.appendChild(o),$("body").append(i),$("#pesquisar").submit()}function paginateSearch(t,e){let n=getCSRF(),o=getReCaptcha(e),i=document.createElement("form");i.setAttribute("method","POST"),i.setAttribute("action",`${t}`),i.id="pesquisar",i.appendChild(n),i.appendChild(o),$("body").append(i),$("#pesquisar").submit()}function getToken(t,e,n="ajax"){grecaptcha.ready((function(){grecaptcha.execute(KEY_V3_RECAPTCHA,{action:t}).then((function(t){"ajax"==n?sendForm(e,t):"search"==n?pesquisar(e,t):"paginate"==n&&paginateSearch(e,t)}))}))}String.prototype.strstr=function(t){let e=this.indexOf(t);return-1==e?this:this.substring(0,e)},$(document).ready((function(){$(".ajax-form").submit((function(t){this.checkValidity()?(t.preventDefault(),getToken("form-"+this.id,this)):(t.preventDefault(),t.stopPropagation()),this.classList.add("was-validated")})),$(".needs-validation").submit((function(t){if(!1===this.checkValidity())t.preventDefault(),t.stopPropagation(),$(this).addClass("was-validated");else{if(t.preventDefault(),$(this).addClass("was-validated"),"deeplink"==this.id)redirectUrl();else if("search"==this.id){getToken("search",$("#q").val(),"search")}$(this).removeClass("was-validated")}})),navigator.share&&$(".plus-share").removeClass("d-none"),$(".igs").click((function(){alert("Tire print e compartilhe nas suas storys, para fechar dê um duplo clique!"),igShare("#"+$(this).closest(".promo").attr("id"))})),$(".mre").click((function(){let t,e,n;void 0!==$(this).closest(".promo").attr("id")?(e="#"+$(this).closest(".promo").attr("id"),t=getText(e)+"\n",n=getUrl(e)):(e="#"+$(this).closest(".cupom").attr("id"),t=getTextCupom(e)+"\n",n=getUrlCupom(e)),navigator.share({text:t,url:n})})),$(".cpy").click((function(){let t,e,n;void 0!==$(this).closest(".promo").attr("id")?(e="#"+$(this).closest(".promo").attr("id"),t=getText(e),n=getUrl(e)):(e="#"+$(this).closest(".cupom").attr("id"),t=getTextCupom(e),n=getUrlCupom(e)),t+=`\n\n${n}`,copyS(t)})),$(".wpp").click((function(){let t,e,n;void 0!==$(this).closest(".promo").attr("id")?(e="#"+$(this).closest(".promo").attr("id"),t=getText(e),n=getUrl(e)):(e="#"+$(this).closest(".cupom").attr("id"),t=getTextCupom(e),n=getUrlCupom(e)),t+=`\n\n${n}`,window.open("https://api.whatsapp.com/send?text="+encodeURIComponent(t))})),$(".tlg").click((function(){let t,e,n;void 0!==$(this).closest(".promo").attr("id")?(e="#"+$(this).closest(".promo").attr("id"),t="\n"+getText(e),n=getUrl(e)):(e="#"+$(this).closest(".cupom").attr("id"),t="\n"+getTextCupom(e),n=getUrlCupom(e)),window.open("https://telegram.me/share/url?url="+encodeURIComponent(n)+"&text="+encodeURIComponent(t))})),$(".twt").click((function(){let t,e,n;void 0!==$(this).closest(".promo").attr("id")?(e="#"+$(this).closest(".promo").attr("id"),t=getText(e)+"\n\n",n=getUrl(e)):(e="#"+$(this).closest(".cupom").attr("id"),t=getTextCupom(e)+"\n\n",n=getUrlCupom(e)),window.open("https://twitter.com/share?url="+encodeURIComponent(n)+"&text="+encodeURIComponent(t))})),$("#ig-share").dblclick((function(){$(this).addClass("d-none")})),$(window).scroll((function(){let t=$("#cabecalho");$(this).scrollTop()>90?(t.addClass("fixed-top"),t.addClass("shadow"),$("body").css("padding-top",90)):(t.removeClass("fixed-top"),t.removeClass("shadow"),$("body").css("padding-top",0))})),$(".ajax-form").submit((function(t){t.preventDefault(),form=this,grecaptcha.ready((function(){grecaptcha.execute(KEY_V3_RECAPTCHA,{action:"send_form"}).then((function(t){let e=new Object;for(let t of $(form).serializeArray())e[t.name]=t.value;e._token=CSRF,e["g-recaptcha-response"]=t;let n=form.id,o=$(`#${n}-submit`).html(),i=$(`#${n}-submit`),s=`#error-${n}`;i.attr("disabled",!0),i.html("Aguarde ..."),$.ajax({url:form.action,data:JSON.stringify(e),dataType:"json",contentType:"application/json",type:"POST"}).done((function(t){void 0===t.success||void 0===t.message?($(s).html('<p class="erro mt-1">Erro desconhecido :(</p>'),$(s).show("slow")):t.success?($(s).html('<p class="bolder">'+t.message+"</p>"),$(s).show("slow")):($(s).html('<p class="erro mt-1">'+t.message+"</p>"),$(s).show("slow"))})).fail((function(){$(s).html('<p class="erro mt-1">Não foi possível enviar os dados, tente novamente!</p>'),$(s).show("slow")})).always((function(){i.html(o),i.attr("disabled",!1)}))}))}))})),$("#inotify").click((function(){$("#notify").addClass("d-none"),createCookie("no_notify",1,60)})),0==window.location.pathname.indexOf("/search")&&($(".page-link").click((function(t){t.preventDefault(),getToken("paginate",$(this).attr("href"),"paginate")})),$(".filtros").click((function(t){t.preventDefault(),getToken("paginate",$(this).attr("href"),"paginate")}))),$("#prefers input[type='checkbox']").change((function(){$("#prefers input[type='checkbox']").is(":checked")?($("#para").attr("disabled",!0),$("#para").removeAttr("required")):($("#para").attr("disabled",!1),$("#para").attr("required"))})),$("#all").change((function(){$(this).is(":checked")?$(".prefer").attr("checked",!0):$(".prefer").removeAttr("checked")}))}));let sub,isSubscribed=!1,swRegistration=null,btn=$("#btn-notify");function urlB64ToUint8Array(t){const e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=window.atob(e),o=new Uint8Array(n.length);for(let t=0;t<n.length;++t)o[t]=n.charCodeAt(t);return o}function initializeUI(){document.cookie.indexOf("no_notify")<0&&$("#notify").removeClass("d-none"),btn.attr("disabled",!1),btn.click((function(){btn.attr("disabled",!0),btn.html("Aguarde ..."),isSubscribed?unsubscribeUser():subscribeUser()})),swRegistration.pushManager.getSubscription().then((function(t){sub=t,isSubscribed=!(null===t),isSubscribed&&"/notificacoes"==window.location.pathname&&(getPrefer(t.endpoint),$("#endpoint").val(t.endpoint)),updateBtn()}))}function updateBtn(){if("denied"===Notification.permission)return $("#btn-notify").html("Notificações bloqueadas"),$("#btn-notify").attr("disabled",!0),$("#notify-bloqued").removeClass("d-none"),void(sub&&update("remove"));btn.attr("disabled",!1),isSubscribed?(setTimeout((function(){createCookie("no_notify",1,60),$("#notify").hide("slow")}),1e3),btn.html("Desativar notificações")):btn.html("Ativar notificações")}function subscribeUser(){const t=urlB64ToUint8Array(KEY_VAPID_PUBLIC);swRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:t}).then((function(t){sub=t,update("add")})).catch((function(){updateBtn()}))}function unsubscribeUser(){sub?(sub.unsubscribe(),update("remove"),$("#preferencias").addClass("d-none")):updateBtn()}function update(t){grecaptcha.ready((function(){grecaptcha.execute(KEY_V3_RECAPTCHA,{action:"notify"}).then((function(e){const n={subscription:sub,action:t,token:e,_token:CSRF};$.ajax({url:"/register",type:"POST",data:JSON.stringify(n),dataType:"json",contentType:"application/json",success:function(e){processResponse(e,t)}}).fail((function(){return $("#notify").append('<p class="erro mt-2 center">Erro desconhecido!</p>'),sub&&sub.unsubscribe(),updateBtn()}))}))}))}function processResponse(t,e){return void 0===t.success?($("#notify").append('<p class="erro mt-2 center">Erro desconhecido!</p>'),sub&&sub.unsubscribe()):t.success&&"add"==e?isSubscribed=!0:t.success&&"remove"==e?isSubscribed=!1:void 0!==t.erro?($("#notify").append('<p class="erro mt-2 center">'+t.erro+"</p>"),sub&&sub.unsubscribe()):($("#notify").append('<p class="erro mt-2 center">Erro desconhecido!</p>'),sub&&sub.unsubscribe()),updateBtn()}"serviceWorker"in navigator&&"PushManager"in window?navigator.serviceWorker.register("/sw.js").then((function(t){swRegistration=t,initializeUI()})):(btn.html("Notificações não suportadas"),$("#notify-unsupport").removeClass("d-none"));
